var $=jQuery.noConflict();
(function(g,f,V){function L(b,d){var c=document.getElementById(b);if(c&&(d=f(c).find('[id*="'+d+'"]')[0])){var a="";f(d).is("select")&&(a=d.options[0].text);"styled-select"==f(d).parent().attr("class")&&(d.options[0].selected=!0,g.switchInstructions(b,0),d=f(d).parent()[0]);var e=f(d).prop("tagName");null!=e&&"form"==e.toLowerCase()&&(e=f(c).find("#"+h.methodSelectDowload),e.prop("checked",!0),e=f(e).parent(),"label"==f(e).prop("tagName").toLowerCase()&&(f(e).removeClass("active").addClass("active"),f(e).siblings().removeClass("active")),
f(c).find("p."+h.shippingPolicyClass).hide(),d=f(d).parent()[0]);null==f(c).find(".downloadText")[0]&&null==f(c).find(".no-select")[0]&&f(d).before("<span class='no-select'>"+a+"</span>");f(d).hide();x("Hiding selector within group: "+b)}}function N(b,d,c){var a=[],e;for(e in b)b.hasOwnProperty(e)&&("object"==typeof b[e]?a=a.concat(N(b[e],d,c)):e==d&&b[d]==c&&a.push(b));return a}function J(b,d){val="";b.hasOwnProperty(d)&&(val=b[d]);return val}function C(){var b="",d=f(document).find("[data-promo-code]");
0<d.length&&(b=f(d[0]).data("promoCode"));""==b&&(b=g.getQueryStringParam(h.promoQueryString));""==b&&(b=g.getCookie(h.promoCookie));""!=b&&Q(h.promoCookie,b);return b}function R(){function b(){setTimeout(function(){if("undefined"!=typeof window.tracking&&"undefined"!=typeof window.tracking.setProductsInfo){var d={};d.currency=E[g.getCurrency()];d.products=[];for(var c=0;c<p.length-1;c++){var a={};a.sku=p[c].sku;a.price=""!=p[c].salePrice?p[c].salePrice:p[c].listPrice;d.products.push(a)}tracking.setProductsInfo(d)}else null==
l.tracking&&(l.tracking=h.interval),l.tracking<h.timeout&&(l.tracking+=h.interval,b())},h.interval)}b()}function S(b){var d="",c=g.getQueryStringParam(h.currencyQueryString);5==c.length&&(d=c);if(""==d)if(d=g.getCookie(h.currencyCookie),""==d){var a="";c=window.location.host;b&&(c=b);c=g.getBrandInfo(c);d="";if(b||-1<window.location.host.indexOf("local."))d=c.domain;-1<window.location.hostname.indexOf("ipm.")&&(d="ipm.corel.com");var e="";e="mindmanager"==c.id?g.buildEnvironmentURL(d,"/geolookup/"):
g.buildEnvironmentURL(d,"/geolookup.html");x("Looking up geo location from: "+e,!0);f.ajax({type:"GET",url:e,cache:!1,async:!1,success:function(w,F,r){if(w=r.getResponseHeader("True-Client-Country-4JS"))a=w.toLowerCase(),x("GeoIP detected country: "+a,!0)}});d=c.defaultCurrency;for(e=0;e<v.length;e++){var k=v[e].countries.split(",");if(-1!=f.inArray(a,k)){v[e].hasOwnProperty("exclude")?(k=v[e].exclude.split(","),-1==f.inArray(c.id,k)&&(d=v[e].currency)):v[e].hasOwnProperty("include")?(k=v[e].include.split(","),
-1!=f.inArray(c.id,k)&&(d=v[e].currency)):d=v[e].currency;break}}x("Using currency from IP detection mapping: "+d,!0)}else x("Using currency from session cookie: "+d,!0);else x("Using currency from querystring: "+d,!0);M=d;V==b&&Q(h.currencyCookie,d)}function T(b,d,c,a,e){var k=[],w=g.getCurrency(),F=N(d.price_data,"currency",w);if(0<F.length){F=F[0];x("Found data for currency: "+w,!0);for(var r=0;r<b.length;r++){var t={},O=C(),y=N(F.products,"sku",b[r]);0==y.length&&(y=N(F.products,"pid",b[r]));
if(0<y.length&&!c){y=y[0];var P="",K=null;t.sku=null==y.sku?y.pid:y.sku;t.partnerID=y.pid;O&&(K=N(y.xtra,"promo",O),0<K.length?(x("Found data for promo: "+O+" for SKU: "+b[r]),K=K[0]):(x("Didn't find data for promo: "+O+" for SKU: "+b[r]),K=null,O=""));t.promo=O;null==K?(y.hasOwnProperty("price")?t.listPrice=y.price:y.hasOwnProperty("xtra")&&(t.listPrice=y.xtra[0].price),t.salePrice=J(y,"sale"),t.savings=J(y,"sv"),t.valueAdd=J(y,"va")):(t.salePrice=J(K,"sale"),K.hasOwnProperty("price")?t.listPrice=
K.price:y.hasOwnProperty("price")&&(t.listPrice=y.price),t.savings=J(K,"sv"),t.valueAdd=J(K,"va"),P=J(K,"url"));x("Price for SKU "+b[r]+": "+t.listPrice+"(List), "+(""==t.salePrice?"n/a":t.salePrice)+"(Sale)");""==P&&(P=y.hasOwnProperty("url")?y.url:F.url);V!=P?(t.buyLink=I(y,P),U(t)):t.buyLink="";k[r]=t}else if(0<y.length&&c){if(y=y[0],y.hasOwnProperty("xtra")){O=[];for(n=0;n<y.xtra.length;n++)t={},P="",t.sku=y.sku,t.partnerID=J(y,"pid"),t.minQty=y.xtra[n].min,t.maxQty=y.xtra[n].max,t.listPrice=
y.xtra[n].price,t.promo="",x("Price for SKU "+b[r]+", tier "+(n+1)+": "+t.listPrice+" (min:"+t.minQty+", max:"+t.maxQty+")"),P=y.xtra[n].hasOwnProperty("url")?y.xtra[n].url:y.hasOwnProperty("url")?y.url:F.url,V!=P?(t.buyLink=I(y,P),U(t)):t.buyLink="",O.push(t);k[r]=O}}else d.hasOwnProperty("physical_skus")&&-1!=f.inArray(b[r],d.physical_skus)?(t.sku=b[r],t.partnerID=b[r],t.missingPhysical=!0,k[r]=t,x("Didn't find pricing for physical SKU "+b[r])):x("Didn't find pricing for SKU "+b[r])}}f(k).filter(function(X){return k[X]!==
V}).length<b.length&&(a?(a=window.location.host,e&&(a=e),a=g.getBrandInfo(a).defaultCurrency,a!=w?(x("Didn't find pricing for all SKUs, try using default currency: "+a),M=a,k=T(b,d,c,!1,e)):x("Didn't find pricing for all SKUs, already using deafault currency: "+w)):x("Didn't find pricing for all SKUs, but not falling back"));return k}function I(b,d){var c=d,a=d.match(/%\w*%/ig);if(null!=a)for(var e=0;e<a.length;e++)"%sku%"==a[e]?c=b.hasOwnProperty("slsku")?c.replace(a[e],b.slsku):c.replace(a[e],b.sku):
"%pid%"==a[e]&&(c=c.replace(a[e],b.pid));return c}function U(b){var d=b.buyLink,c=d;if(-1!=d.indexOf("/store.")||-1!=d.indexOf("/shop.pinnaclesys")||"winzip"==g.getBrandInfo(window.location.host).id){var a=g.getQueryStringParam(h.cjeventQueryString);if(""!=a){var e=h.cjeventCookie,k=a;var w=new Date;w.setTime(w.getTime()+3888E6);w="; expires="+w.toGMTString();document.cookie=e+"="+k+w+"; path=/"}else a=g.getCookie(h.cjeventCookie);""!=a&&(c=-1==d.indexOf("?")?c+("?"+h.cjeventBuyLinkQueryString+"="+
a):c+("&"+h.cjeventBuyLinkQueryString+"="+a))}d=c;c="";if(-1!=d.indexOf("/store.")||-1!=d.indexOf("/shop.pinnaclesys")||"winzip"==g.getBrandInfo(window.location.host).id){a=g.getCookie(h.stubCookie);e=g.getCookie(h.xparamCookie);if(""==e){if(e=window.location.search.match(/[?&]x-(.*?)=/ig),null!=e){for(k=0;k<e.length;k++)if(w=e[k].substring(1,e[k].length-1),""==a||"x-at"!=w&&"x-channel"!=w)""!=c&&(c+="&"),c+=e[k].substring(1)+g.getQueryStringParam(w);Q(h.xparamCookie,c)}}else c=e;""!=a&&(c=""!=c?
c+"&"+a:a);""!=c&&(c=-1==d.indexOf("?")?"?"+c:"&"+c)}a=d+=c;-1!=d.indexOf("/store.")&&(c=g.getBrandInfo(d),"corel"==c.id||"cdgs"==c.id||"painter"==c.id||"wp"==c.id)&&(e=d.match(/languages=[a-z]{2}/i),k=d.match(/deliveryCountryId=[a-z]{2}/i),a="",null!=e&&null!=k&&(a=e[0].substring(e[0].length-2).toLowerCase()+"_"+k[0].substring(k[0].length-2).toUpperCase(),"zg_TW"==a&&(a="ct_TW")),e="corel"==g.getBrandInfo(window.location.href).id?"http://www.corel.com":"http://www"+c.domain+"com/",a=d+"&x-brandId="+
c.id+"&x-locale="+a+"&x-workflow=checkout&continueurl="+e);d=a;-1!=b.promo.indexOf("seclink")||"true"!=g.getQueryStringParam("ipm").toLowerCase()&&"ipm"!=g.getBrandInfo(window.location.href).id||(c="",a=g.getBrandInfo(d),-1==d.indexOf("/store.")||"cdgs"!=a.id&&"painter"!=a.id&&"wp"!=a.id?-1==d.indexOf("/store.")||"psp"!=a.id&&"vsp"!=a.id&&"wdvd"!=a.id&&"asp"!=a.id?-1!=d.indexOf("/estore.")&&(a=g.getQueryStringParam("pculicenseid"),""==a&&(a=g.getQueryStringParam("license_id")),""==a&&(a=g.getQueryStringParam("licenseid")),
c="/ThemeID.38164200/license_id."+a+"/clearcart.yes"):(c=-1==d.indexOf("?")?"?":"&",c=c+"cfg=corel_inapp&x-serial="+g.getQueryStringParam("serial"),a=g.getQueryStringParam("pculicenseid"),""==a&&(a=g.getQueryStringParam("license_id")),""==a&&(a=g.getQueryStringParam("licenseid")),c+="&x-licenseid="+a,a=g.getQueryStringParam("pcusourceid"),""==a&&(a=g.getQueryStringParam("source_id")),""==a&&(a=g.getQueryStringParam("sourceid")),c+="&x-sourceid="+a,a=d.match(/x-ipm=(.*?)?&/i),null!=a&&null!=a[0]?d=
-1!=a[0].indexOf("&")?d.replace(a[0],"x-ipm=trial&"):d.replace(a[0],"x-ipm=trial"):c+="&x-ipm=trial"):(c="&maxquantity=1&cartreset=true&x-ipm=true&x-serial="+g.getQueryStringParam("serial"),a=g.getQueryStringParam("pculicenseid"),""==a&&(a=g.getQueryStringParam("license_id")),""==a&&(a=g.getQueryStringParam("licenseid")),c+="&x-licenseid="+a,a=g.getQueryStringParam("pcusourceid"),""==a&&(a=g.getQueryStringParam("source_id")),""==a&&(a=g.getQueryStringParam("sourceid")),c+="&x-sourceid="+a,a=g.getQueryStringParam("profileid"),
""!=a&&(c+="&x-profileid="+a),a=g.getQueryStringParam("hfpid"),""!=a&&(c+="&x-hwid="+a),-1!=d.indexOf("cfg=samltest")?d=d.replace("cfg=samltest","cfg=corelinapp2014_saml"):c+="&cfg=corelinapp2014"),d+=c);c=d;-1!=d.indexOf("/store.")&&(d=g.getQueryStringParam(h.affiliate),""!=d&&(c+="&"+h.affiliate+"="+d));d=c;"true"!=g.getQueryStringParam("ipp")?(c=g.getBrandInfo(window.location.href).id,a=g.getBrandInfo(d).id,c!=a&&(d=W(d))):d=W(d);x("Adjusted buy link for SKU "+b.sku+": "+d);b.buyLink=d}function W(b){var d=
g.getQueryStringParam("utm_source"),c=g.getQueryStringParam("utm_medium"),a=g.getQueryStringParam("utm_campaign"),e=g.getQueryStringParam("utm_content"),k=g.getQueryStringParam("utm_term");""!=d&&(b=-1==b.indexOf("?")?b+("?utm_source="+d):b+("&utm_source="+d));""!=c&&(b=-1==b.indexOf("?")?b+("?utm_medium="+c):b+("&utm_medium="+c));""!=a&&(b=-1==b.indexOf("?")?b+("?utm_campaign="+a):b+("&utm_campaign="+a));""!=e&&(b=-1==b.indexOf("?")?b+("?utm_content="+e):b+("&utm_content="+e));""!=k&&(b=-1==b.indexOf("?")?
b+("?utm_term="+k):b+("&utm_term="+k));return b}function Q(b,d){document.cookie=b+"="+d+"; path=/"}function x(b,d){var c=g.getQueryStringParam(h.debugQueryString);""==c?c=g.getCookie(h.debugCookie):Q(h.debugCookie,c);c=c.split("-");if(-1!=f.inArray("price",c)){try{var a="";if(window.performance&&"function"===typeof window.performance.now)a=performance.now().toLocaleString();else{var e=new Date(Date.now());a=e.getMinutes()+":"+e.getSeconds()+"."+e.getMilliseconds()}console.debug("Pricing ("+a+") - "+
b)}catch(k){}-1!=f.inArray("app",c)&&1==d&&alert(window.location.host+": "+b)}}g.getCurrency=function(){return M};g.getSelectedSKU=function(){return u};g.getPriceDetails=function(){return p};g.setPriceDetails=function(b){p=b};g.getTimedOut=function(){return B};g.setTimedOut=function(b){B=b};g.getDataReceived=function(){return G};g.initPriceData=function(b,d,c,a,e){function k(){setTimeout(function(){jQuery.isEmptyObject(q)?(null==l.initData&&(l.initData=h.interval),l.initData<h.timeout&&0==G&&(x("No price data yet, check again in "+
h.interval+"ms (waited: "+l.initData+"ms so far)"),l.initData+=h.interval,k())):(G=!0,p=T(b,q,d,c,a),"undefined"!==typeof e&&e(p))},h.interval)}0==D&&(D=!0,"undefined"!==typeof a&&""!=a&&(jQuery.isEmptyObject(q)&&!jQuery.isEmptyObject(m)?(x("Aborting current price data load, need to load from another domain: "+a),m.abort()):x("Need to reload price data from another domain: "+a),q={},g.loadJSON(a)),S(a),k())};g.init=function(b,d){function c(){setTimeout(function(){if(0<p.length){for(var a=g.getCurrency(),
e=0;e<p.length;e++)if(null!=p[e]){var k=f(document).find(h.pricePrefix+(e+1));if(k)for(var w=0;w<k.length;w++){var F=f(k[w]).find(h.textStrikethrough)[0],r=f(k[w]).find(h.textNormal)[0];""!=p[e].salePrice?(F&&(F.innerHTML=p[e].listPrice,f(F).formatCurrency({region:a})),r&&(r.innerHTML=p[e].salePrice,f(r).formatCurrency({region:a}))):r&&(r.innerHTML=p[e].listPrice,f(r).formatCurrency({region:a}));x("Inserted pricing into DOM for: "+f(k[w]).attr("class")+" ("+p[e].sku+")")}}if("true"==g.getQueryStringParam("automation")){e=
g.getCurrency();k="<div id='priceDetails' style='display:none;'>";f("body").append("<div id='priceFormatting' style='display:none;'></div>");for(w=0;w<p.length;w++)a=p[w],f("#priceFormatting").html(a.listPrice),f("#priceFormatting").formatCurrency({region:e}),a.listPriceFormatted=f("#priceFormatting").html(),f("#priceFormatting").html(a.salePrice),f("#priceFormatting").formatCurrency({region:e}),a.salePriceFormatted=f("#priceFormatting").html(),k+="<span class='"+a.sku+"'>",k+=JSON.stringify(a),k+=
"</span>";k+="</div>";f("body").append(k);f("#priceFormatting").remove()}R();"undefined"!=typeof dataLayer&&(a={event:"e_structuredDataReady"},a.structuredDataCurrency=E[g.getCurrency()],a.structuredDataSku=p[0].sku,a.structuredDataListPrice=p[0].listPrice,dataLayer.push(a));z=!0}else null==l.init&&(l.init=h.interval),l.init<h.timeout&&0==G?(x("No price data yet, check again in "+h.interval+"ms (waited: "+l.init+"ms so far)"),l.init+=h.interval,c()):0==B&&(0==G?(dataLayer.push({event:"priceDataTimeout"}),
x("No price data - timeout reached, aborting (priceDataTimeout GA event)")):x("No valid price data found."),B=!0)},h.interval)}g.initPriceData(b,!1,!0,d);c()};g.display=function(b,d){setTimeout(function(){if(z){var c=g.getIndex(d);if(0<=c){u[b]=p[c].sku;var a=document.getElementById(b);if(a){var e=f(a).find(h.pricePrefix+(c+1))[0];e&&(e.style.display="inline");var k=f(a).find(h.buyLink)[0],w=f(a).find(h.buyLink).first();k&&(""==p[c].buyLink&&(p[c].buyLink=k.href,U(p[c])),k.href=p[c].buyLink,k.setAttribute("data-track-event",
"e_addToCart"),k.setAttribute("data-track-attr-productsku",p[c].sku));if(e=f(a).find(h.skuPrefix+(c+1))[0]){e.checked="checked";e.selected=!0;if("label"==f(e).parent().prop("tagName").toLowerCase()){f(e).parent().removeClass("active").addClass("active");f(e).parent().siblings().removeClass("active");var F=f(a).find("#"+h.methodSelectDowload).parent().text().trim(),r=f(a).find("p[class*='delivery-method']");r&&f(r).html("Delivery: <span class='no-select'>"+F+"</span>")}e.hasAttribute("value")&&k&&
w.text(e.value)}if(k=f(a).find(h.inclVAT)[0])-1!=f.inArray(g.getCurrency(),H)?k.style.display="inline":k.style.display="none";x("Displayed price details for SKU: "+d+", in location: "+b,!0);c+2<p.length&&null!=f(a).find('[id*="'+h.methodSelect+'"]')[0]?p[c+2].hasOwnProperty("missingPhysical")&&L(b,h.methodSelect):c+1<p.length&&p[c+1].hasOwnProperty("missingPhysical")&&L(b,f(e).parent("select").attr("id"))}}}else null==l[b]&&(l[b]=h.interval),l[b]<h.timeout?(x("Pricing not inserted yet, waiting to display: "+
b+" (waited: "+l[b]+"ms so far)"),l[b]+=h.interval,g.display(b,d)):x("No price data inserted - timeout reached, aborting")},h.interval)};g.updateDisplay=function(b,d,c,a){x("Updating pricing display for location: "+b);var e=parseInt(d.id.substr(d.id.lastIndexOf(h.delimiter)+1))-1,k=!1;"label"==f(d).parent().prop("tagName").toLowerCase()&&(k=!0);isNaN(e)&&(k?e=f(d).parent().index():(e=d.selectedIndex,d=d.options[d.selectedIndex]));var w=document.getElementById(b),F=-1;if(null!=a){if(-1!=a.indexOf("method-select")){var r=
g.getBrandInfo(window.location.host).domain;if(e+2<p.length&&p[e+2].sku!=r.replace(/www|\./gi,""))if(p[e+2].hasOwnProperty("missingPhysical"))L(b,h.methodSelect);else{var t=h.methodSelect;if(r=document.getElementById(b)){(textElement=f(r).find(".no-select")[0])&&f(textElement).remove();if(t=f(r).find('[id*="'+t+'"]')[0])f(t).parent().show(),x("Showing selector within group: "+b);t=f(t).prop("tagName");null!=t&&"form"==t.toLowerCase()&&f(r).find("p."+h.shippingPolicyClass).show()}}}if(r=f(w).find("#"+
a)[0])F=r.selectedIndex;if(null==F||-1==F)(r=f("input[name="+a+"]:checked")[0])&&(F=parseInt(r.id.substr(r.id.lastIndexOf(h.delimiter)+1))-1),k&&(isNaN(F)?(r=f(r).parent(),k=r.text().trim(),F=f(r).index()):(r=f(d).parent(),k=r.text().trim()),r=f(w).find("p[class*='delivery-method']"),null!=k&&r&&f(r).html("Delivery: <span class='no-select'>"+k+"</span>"));if(-1!=F){if(-1!=a.indexOf(h.methodSelect)&&0<F||-1!=a.indexOf(h.versionSelect)&&0<e)e+=1;e+=F}}else!k&&d.hasAttribute(h.dataPricingIndexAdjustment)&&
(e=parseInt(d.getAttribute(h.dataPricingIndexAdjustment)));if(null!=p[e]){u[b]=p[e].sku;b=f(w).find(h.buyLink)[0];""!=p[e].buyLink&&(b.href=p[e].buyLink);b.setAttribute("data-track-attr-productsku",p[e].sku);d.hasAttribute("value")&&f(w).find(h.buyLink).first().text(d.value);if(c)for(c=0;c<p.length;c++)if(d=f(w).find(h.pricePrefix+(c+1))[0])d.style.display=c==e?"inline":"none";x("Updated price display to show SKU: "+p[e].sku,!0);x("List price is: "+p[e].listPrice+", Sale price is: "+p[e].salePrice);
x("Buy link is: "+p[e].buyLink)}};g.switchInstructions=function(b,d){var c=document.getElementById(b),a=f(c).find("[class*='"+h.instructions+"']");if(0<a.length)for(var e=0;e<a.length;e++)c=parseInt(a[e].className.substr(a[e].className.lastIndexOf(h.instructions)+h.instructions.length))-1,c==d?(a[e].style.display="inline-block",x("Switching instructions to #"+(d+1))):a[e].style.display="none"};g.changeCurrency=function(b){Q(h.currencyCookie,b);var d=g.getQueryStringParam(h.currencyQueryString);d?
window.location.href=window.location.href.replace(h.currencyQueryString+"="+d,h.currencyQueryString+"="+b):window.location.reload()};g.buildEnvironmentURL=function(b,d){var c=d;if(b){var a="";c=window.location.host;var e=g.getBrandInfo(b).id;0==b.indexOf(".")&&(b="www"+b);b.lastIndexOf(".")==b.length-1&&(b+="com");-1<c.indexOf("dev.")?a="dev.":-1<c.indexOf("stg.")?a="stg.":-1<c.indexOf("local.")&&(a=-1!=d.indexOf("geolookup.html")?"dev.":"local.");""!=a&&(""!=e&&(b=a+b),""!=e&&"local."!=a&&(b=-1<
b.indexOf(".io")?b.replace(".io",".public.corel.net"):b.replace(".com",".public.corel.net")));a=window.location.protocol;"true"==g.getQueryStringParam("forcehttps")&&-1==c.indexOf("local.")&&(a="https:");c=a+"//"+b+d}return c};g.loadJSON=function(b){var d="";d="";d=b&&""!=b?g.getBrandInfo(b).dataDir:g.getBrandInfo(window.location.host).dataDir;d=g.buildEnvironmentURL(b,"/static/"+d+"/data/price_data.json");x("Getting price data from: "+d,!0);m=f.ajax({type:"GET",url:d,cache:!0,ifModified:!0,async:!0,
jsonpCallback:"price_data",contentType:"application/json",dataType:"jsonp",success:function(c){q=c}})};g.getQueryStringParam=function(b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");b=(new RegExp("[\\?&]"+b+"=([^&#]*)")).exec(location.search);return null==b?"":decodeURIComponent(b[1].replace(/\+/g," "))};g.getCookie=function(b){var d="";0<document.cookie.length&&(c_start=document.cookie.indexOf(b+"="),-1!=c_start&&(c_start=c_start+b.length+1,c_end=document.cookie.indexOf(";",c_start),-1==c_end&&
(c_end=document.cookie.length),d=unescape(document.cookie.substring(c_start,c_end))));return d};g.getBrandInfo=function(b){for(var d=A[0],c=1;c<A.length;c++)if(-1!=b.indexOf(A[c].domain)){d=A[c];break}return d};g.getIndex=function(b){for(var d=-1,c=0;c<p.length;c++)if(null!=p[c]&&p[c].sku&&p[c].partnerID&&b&&(p[c].sku.toLowerCase()==b.toLowerCase()||p[c].partnerID.toLowerCase()==b.toLowerCase())){d=c;break}return d};var M="",p=[],q={},m={},u={},l=[],z=!1,D=!1,B=!1,G=!1,v=[{currency:"en-US",countries:"us"},
{currency:"en-CA",countries:"ca"},{currency:"en-GB",countries:"gb"},{currency:"en-AU",countries:"au"},{currency:"en-NZ",countries:"nz",exclude:"mindmanager"},{currency:"de-DE",countries:"de,at",exclude:"wp"},{currency:"fr-FR",countries:"fr"},{currency:"it-IT",countries:"it",exclude:"painter,wp"},{currency:"nl-NL",countries:"nl",exclude:"painter,wp"},{currency:"pt-BR",countries:"br",exclude:"photomirage,mindmanager"},{currency:"ja-JP",countries:"jp"},{currency:"zh-TW",countries:"tw",exclude:"asp,wdvd,wp,mindmanager"},
{currency:"zh-HK",countries:"hk",exclude:"asp,wdvd,wp,mindmanager"},{currency:"zh-CN",countries:"cn",include:"cdgs,corel,winzip,painter"},{currency:"en-IE",countries:"ba,be,bg,cs,cy,ee,fi,gi,gl,gr,hr,hu,ie,il,im,ir,is,lb,li,lt,lu,lv,ly,mc,me,mk,mt,ps,pt,ro,rs,sd,sl,sk,sm,sy,tr,va"},{currency:"se-SE",countries:"se"},{currency:"nb-NO",countries:"no"},{currency:"da-DK",countries:"dk",exclude:"photomirage"},{currency:"de-LI",countries:"ch",exclude:"photomirage"},{currency:"en-ZA",countries:"za"},{currency:"es-MX",
countries:"mx",exclude:"wp"},{currency:"es-ES",countries:"es",exclude:"painter,wp,mindmanager"},{currency:"pl-PL",countries:"pl",exclude:"painter,wp,mindmanager,photomirage,winzip"},{currency:"ru-RU",countries:"am,az,by,ge,kg,kz,md,ru,tj,tm,ua,uz",exclude:"painter,wp"},{currency:"cs-CZ",countries:"cz",include:"cdgs,corel,winzip"},{currency:"en-IN",countries:"in",exclude:"pinnacle,roxio,photomirage,mindmanager"},{currency:"es-AR",countries:"ar",include:"cdgs,corel"},{currency:"es-CL",countries:"cl",
include:"cdgs,corel,winzip"},{currency:"es-CO",countries:"co",include:"cdgs,corel"},{currency:"es-PE",countries:"pe",include:"cdgs,corel"},{currency:"en-MY",countries:"my",exclude:"pinnacle,roxio,photomirage,mindmanager,winzip"},{currency:"en-SG",countries:"sg",exclude:"pinnacle,roxio,photomirage,mindmanager"},{currency:"ko-KR",countries:"kr",exclude:"wp,pinnacle,roxio,photomirage,mindmanager"},{currency:"en-RW",countries:"yy",include:"cdgs,corel"}],H="en-GB de-DE fr-FR it-IT nl-NL en-IE es-ES se-SE da-DK pl-PL cs-CZ nb-NO de-LI ja-JP en-AU en-ZA en-NZ ru-RU en-IN en-MY es-CO ko-KR zh-TW en-SG tr-TR".split(" "),
E={"en-US":"USD","en-CA":"CAD","en-GB":"GBP","en-AU":"AUD","en-NZ":"NZD","de-DE":"EUR","fr-FR":"EUR","it-IT":"EUR","nl-NL":"EUR","pt-BR":"BRL","ja-JP":"JPY","zh-TW":"TWD","zh-HK":"HKD","en-IE":"EUR","en-RW":"USD","se-SE":"SEK","nb-NO":"NOK","da-DK":"DKK","de-LI":"CHF","en-ZA":"ZAR","es-MX":"MXN","es-ES":"EUR","pl-PL":"PLN","ru-RU":"RUB","cs-CZ":"CZK","en-IN":"INR","es-AR":"ARS","es-CL":"CLP","es-CO":"COP","es-PE":"PEN","en-MY":"MYR","en-SG":"SGD","ko-KR":"KRW","zh-CN":"CNY","tr-TR":"TRY","vi-VN":"VND",
"id-ID":"IDR"},A=[{id:"",dataDir:"",domain:"",defaultCurrency:""},{id:"cdgs",dataDir:"cdgs",domain:".coreldraw.",defaultCurrency:"en-RW"},{id:"painter",dataDir:"ptr",domain:".painterartist.",defaultCurrency:"en-US"},{id:"wp",dataDir:"wpo",domain:".wordperfect.",defaultCurrency:"en-US"},{id:"psp",dataDir:"psp",domain:".paintshoppro.",defaultCurrency:"en-US"},{id:"vsp",dataDir:"vsp",domain:".videostudiopro.",defaultCurrency:"en-US"},{id:"wdvd",dataDir:"wdvd",domain:".windvdpro.",defaultCurrency:"en-US"},
{id:"asp",dataDir:"asp",domain:".aftershotpro.",defaultCurrency:"en-US"},{id:"pinnacle",dataDir:"pin",domain:".pinnaclesys.",defaultCurrency:"en-US"},{id:"photomirage",dataDir:"pm",domain:".photomirage.",defaultCurrency:"en-US"},{id:"roxio",dataDir:"roxio",domain:".roxio.",defaultCurrency:"en-US"},{id:"mindmanager",dataDir:"mm",domain:"mindmanager.",defaultCurrency:"en-US"},{id:"mindmanager",dataDir:"mm",domain:"mindjet.",defaultCurrency:"en-US"},{id:"winzip",dataDir:"wz",domain:".winzip.",defaultCurrency:"en-US"},
{id:"corel",dataDir:"corel",domain:".corel.",defaultCurrency:"en-RW"}],h={pricePrefix:".dynPrice_Price_",skuPrefix:"#dynPrice_SKU_",buyLink:".BuyLink",textStrikethrough:".priceDisplayStrikethrough",textNormal:".priceDisplayNormal",delimiter:"_",inclVAT:".inclVAT",instructions:"dynPrice_instructions_",currencyCookie:"dynPrice_CurrencyRegion",currencyQueryString:"currency",affiliate:"affiliate",promoQueryString:"promo",promoCookie:"dynPrice_promoCookie",xparamCookie:"dynPrice_xparamCookie",stubCookie:"stub-trk-param",
region:"region",lang:"lang",debugQueryString:"debug",debugCookie:"corel_webDebug",cjeventQueryString:"cjevent",cjeventCookie:"dynPrice_cjEvent",cjeventBuyLinkQueryString:"x-cjevent",methodSelect:"method-select",versionSelect:"version-select",methodSelectDowload:"dynPrice_download",methodSelectPhysical:"dynPrice_box",shippingPolicyClass:"shipping-policy",dataPricingIndexAdjustment:"data-pricing-index-adjustment",interval:100,timeout:1E4}})(window.pricing=window.pricing||{},jQuery);
""==pricing.getQueryStringParam("dynprice-crossdomain")&&pricing.loadJSON("");
(function(g,f,V){function L(m,u,l,z,D){var B=!1,G=D.toString()+(""!=D.id?"#"+D.id:"."+D.className),v=J();switch(z){case q.promoText:var H=q.propText;var E="innerHTML";break;case q.promoLink:H=q.propLink;E="href";break;case q.promoImage:H=q.propImage;E="src";break;case q.promoAlt:H=q.propAlt;E="alt";z=q.promoImage;break;case q.promoStyle:H=q.propStyle;E="style";break;case q.promoVar:H=q.propVar;E="innerHTML";break;default:return}for(var A=0;A<l.length;A++){var h=f(l[A]).data(z);if(H!=q.propVar){var b=
"";"object"==typeof m[h]?m[h].hasOwnProperty(H)&&(b=m[h][H]):m.hasOwnProperty(h)&&(b=m[h])}else b="%"+h+"%";"href"==E&&m.hasOwnProperty("hswDetails")&&0==h.indexOf("hsw")&&(b="#");var d=u,c=b;b=b.match(/%\w*%/ig);var a=pricing.getPriceDetails();if(null!=b){d=pricing.getIndex(d);for(var e=0;e<b.length;e++)if(b[e]==q.savingsVar)if(""!=a[d].savings)c=c.replace(b[e],a[d].savings);else{c="";break}else if(b[e]==q.valueAddVar)if(""!=a[d].valueAdd)c=c.replace(b[e],a[d].valueAdd);else{c="";break}}b=c;if(m.hasOwnProperty("hsw")&&
0==h.indexOf("hsw")&&m.hsw.hasOwnProperty("exclusionlist")){a:{c=m.hsw.exclusionlist.split(",");a=location.protocol+"//"+location.host+location.pathname;d=!1;for(e=0;e<c.length;e++)if(-1<c[e].indexOf("*")){var k=c[e].replace("*","");if(-1<location.pathname.indexOf(k)){c=!0;break a}}else{-1<location.pathname.indexOf(".")?(k=a.substr(0,a.lastIndexOf(".")),d=!0):k=a;var w=k.lastIndexOf("/")+1;k=k.substr(0,w);w=k.substr(0,k.length-c[e].length)+c[e];d&&(a=a.substr(0,k.length));if(a==w){c=!0;break a}}c=
!1}if(c)return C("Exclusion match found, do not show HSW."),document.getElementById("headersw").style.display="none",!1}""!=b?(C("Inserting "+h+"("+z+"), using SKU:"+u+", at element:"+G),"style"==E?f(l[A]).css(h,b):l[A][E]=b,"href"==E&&(-1<b.indexOf("http://")||-1<b.indexOf("https://"))&&0!=h.indexOf("hsw")?l[A].target="_blank":"href"==E&&"nopopup-link"==l[A].className?l[A].className="promo-popup-link":"href"!=E||0!=h.indexOf("hsw")||m.hasOwnProperty("hswDetails")||(B=document.createElement("a"),
B.href=b,location.pathname==B.pathname&&(C("Destination same as currenct page, do not add href link."),f(l[A]).removeAttr("href"))),"none"==l[A].style.display&&"style"!=E&&(0==h.indexOf("hsw")?l[A].style.display="block":l[A].style.display="inline-block"),B=!0):"src"==E&&D&&"LI"==f(D).prop("tagName")?f(D).remove():"href"==E&&"promo-popup-link"==l[A].className?l[A].className="nopopup-link":"alt"!=E&&"href"!=E&&u!=v&&(l[A].style.display="none")}return B}function N(m){for(var u=0;u<R.length;u++)if(-1!=
f.inArray(m,R[u].skus))return R[u].promo_details;return null}function J(){var m=pricing.getBrandInfo(window.location.host).domain;return m=m.replace(/www|\./gi,"")}function C(m,u){var l=pricing.getCookie(q.debugCookie).split("-");if(-1!=f.inArray("promo",l)){try{var z="";if(window.performance&&"function"===typeof window.performance.now)z=performance.now().toLocaleString();else{var D=new Date(Date.now());z=D.getMinutes()+":"+D.getSeconds()+"."+D.getMilliseconds()}console.debug("Promotions ("+z+") - "+
m)}catch(B){}-1!=f.inArray("app",l)&&1==u&&alert(window.location.host+": "+m)}}g.getPromosDisplayed=function(){return U};g.getCountdownExpiry=function(){var m=N(J());return m&&m.hasOwnProperty("countdownExpiry")&&(m=m.countdownExpiry)?(m=m.split("/"),{year:parseInt(m[0]),month:parseInt(m[1]),day:parseInt(m[2]),hour:parseInt(m[3])}):null};g.loadJSON=function(m){var u="";u="";u=m&&""!=m?pricing.getBrandInfo(m).dataDir:pricing.getBrandInfo(window.location.host).dataDir;u=pricing.buildEnvironmentURL(m,
"/static/"+u+"/data/promo_data.json");C("Getting promo data from: "+u,!0);T=f.ajax({type:"GET",url:u,cache:!0,ifModified:!0,async:!0,jsonpCallback:"promo_data",contentType:"application/json",dataType:"jsonp",success:function(l){S=l}})};g.init=function(m,u){function l(){setTimeout(function(){if(0<pricing.getPriceDetails().length&&!jQuery.isEmptyObject(S)&&!p){p=M=!0;var D=S,B=[],G=pricing.getCurrency(),v={},H=J(),E=pricing.getPriceDetails();C("Processing promotions for currency: "+G,!0);v[q.propSKU]=
H;E.push(v);for(v=0;v<D.promo_data.length;v++)for(var A=0;A<E.length;A++)if(null!=E[A]&&null!=D.promo_data[v]&&-1!=f.inArray(E[A].sku,D.promo_data[v].skus)){for(H=0;H<D.promo_data[v].promo_details.length;H++)if(null!=D.promo_data[v].promo_details[H]&&-1!=f.inArray(G,D.promo_data[v].promo_details[H].currencyRegions)){C("Promo info for SKU "+E[A].sku+": "+(E[A].hasOwnProperty("savings")?E[A].savings:"n/a")+"(savings), "+(E[A].hasOwnProperty("valueAdd")?E[A].valueAdd:"n/a")+"(value add)");A={};A.skus=
D.promo_data[v].skus;A.promo_details=D.promo_data[v].promo_details[H];B.push(A);break}break}R=B;C("initPromoData(), g_promoData is ready")}else if(null==I.price_and_promo&&(I.price_and_promo=q.interval),I.price_and_promo<q.timeout){if(0==pricing.getDataReceived()?C("No price data yet, check again in "+q.interval+"ms (waited: "+I.price_and_promo+"ms so far)"):C("Valid price data found."),0==M?C("No promo data yet, check again in "+q.interval+"ms (waited: "+I.price_and_promo+"ms so far)"):C("Valid promo data found."),
0==pricing.getDataReceived()||0==M)I.price_and_promo+=q.interval,p||l()}else 0==pricing.getTimedOut()&&(0==pricing.getDataReceived()?(dataLayer.push({event:"priceDataTimeout"}),C("No price data - timeout reached, aborting (priceDataTimeout GA event)")):C("Valid price data found."),pricing.setTimedOut(!0)),0==x&&(0==M?(dataLayer.push({event:"promoDataTimeout"}),C("No promo data - timeout reached, aborting (promoDataTimeout GA event)")):C("Valid promo data found."),x=!0)},q.interval)}var z=pricing.getPriceDetails();
0==W&&(W=!0,0>=z.length&&m&&(C("Price data not initialized, trying to load it now"),pricing.initPriceData(m,!1,!1,u)),"undefined"!==typeof u&&""!=u&&(jQuery.isEmptyObject(S)&&!jQuery.isEmptyObject(T)?(C("Aborting current promo data load, need to load from another domain: "+u),T.abort()):C("Need to reload promo data from another domain: "+u),S={},g.loadJSON(u)),l())};g.display=function(m){setTimeout(function(){if(0<R.length){var u=J();if(null!=f("body.home")[0]){var l=N(u);null!=l&&l.hasOwnProperty(q.propHeroBanner)||
(C("No Hero Banner defined, displaying page content for #heroQuarterly and loading background image"),f("#heroQuarterly").css("display","block"),f("body").addClass("hpBackground"))}if(l=null==m?document.documentElement:document.getElementById(m)){C("Processing promotion locations for: "+(null==m?"Entire page":m),!0);l=f(l).find(q.dataPromoSKU);for(var z=0;z<l.length;z++)if(l[z]){var D=!1,B=f(l[z]).data(q.promoSKU);if(isNaN(B))B==q.selectedSKU&&(B=pricing.getSelectedSKU()[m]);else{var G=pricing.getPriceDetails();
B=B<G.length?G[B-1].sku:null}if(B)if(G=N(B)){var v=f(l[z]).find(q.dataPromoText);0<v.length&&(D=L(G,B,v,q.promoText,l[z]));v=f(l[z]).find(q.dataPromoVar);0<v.length&&(D=L(G,B,v,q.promoVar,l[z]));v=f(l[z]).find(q.dataPromoLink);0<v.length&&L(G,B,v,q.promoLink,l[z]);v=f(l[z]).find(q.dataPromoImage);0<v.length&&(D=L(G,B,v,q.promoImage,l[z]),L(G,B,v,q.promoAlt,z+1));v=f(l[z]).find(q.dataPromoStyle);0<v.length&&L(G,B,v,q.promoStyle,l[z]);G=l[z].toString()+(""!=l[z].id?"#"+l[z].id:"."+l[z].className);1==
D&&"none"==l[z].style.display?(C("Content was inserted within "+(null==m?"Entire page":m)+", displaying element: "+G,!0),l[z].style.display="inline-block"):1==D?C("Content was inserted within "+(null==m?"Entire page":m)+", element already displayed: "+G,!0):0==D&&B!=u&&(C("Nothing was inserted within "+(null==m?"Entire page":m)+", hiding element: "+G,!0),l[z].style.display="none")}else B!=u&&(C("No promo details found for SKU: "+B,!0),l[z].style.display="none")}}U=!0}else u=m,null==m&&(u="page"),
null==I[u]&&(I[u]=q.interval),I[u]<q.timeout&&0==M?(C("No promo data yet, waiting to display: "+u+" (waited: "+I[u]+"ms so far)"),I[u]+=q.interval,g.display(m)):0==Q&&(0==pricing.getPriceDetails().length?C("Didn't get valid price data for promotions - timeout reached (no promo GA event tracked)"):0==M?(dataLayer.push({event:"promoDataTimeout"}),C("No promo data - timeout reached, aborting (promoDataTimeout GA event)")):C("No valid promo data found."),Q=!0,null!=f("body.home")[0]&&(C("No Hero Banner defined, displaying page content for #heroQuarterly and loading background image"),
f("#heroQuarterly").css("display","block"),f("body").addClass("hpBackground")))},q.interval)};var R=[],S={},T={},I=[],U=!1,W=!1,Q=!1,x=!1,M=!1,p=!1,q={propSKU:"sku",selectedSKU:"selectedSKU",dataPromoSKU:"[data-promo-sku]",dataPromoStyle:"[data-promo-style]",promoSKU:"promoSku",promoStyle:"promoStyle",dataPromoText:"[data-promo-text]",dataPromoVar:"[data-promo-var]",promoText:"promoText",promoVar:"promoVar",propText:"txt",propVar:"var",propStyle:"style",dataPromoLink:"[data-promo-link]",promoLink:"promoLink",
propLink:"lnk",dataPromoImage:"[data-promo-image]",promoImage:"promoImage",propImage:"img",promoAlt:"promoAlt",propAlt:"alt",savingsVar:"%savings%",valueAddVar:"%valueadd%",propHeroBanner:"heroBanner",debugCookie:"corel_webDebug",interval:100,timeout:15E3}})(window.promotions=window.promotions||{},jQuery);promotions.loadJSON("");