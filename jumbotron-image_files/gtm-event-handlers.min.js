!function(e){"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),"function"!=typeof document.querySelectorAll&&(document.querySelectorAll=function(e){var t,r=document.createElement("style"),n=[];for(document.documentElement.firstChild.appendChild(r),document._qsa=[],r.styleSheet.cssText=e+"{x-qsa:expression(document._qsa && document._qsa.push(this))}",window.scrollBy(0,0);document._qsa.length;)(t=document._qsa.shift()).style.removeAttribute("x-qsa"),n.push(t);return document._qsa=null,r.parentNode.removeChild(r),n}),e.setProductsInfo=function(e){f=e},e.initDebug=function(){var e=k("debug");"tracking-off"==e?document.cookie="corelGA_Debug=; expires=Sat, 18 Mar 1978 00:00:00 UTC; path=/;":"tracking-on"==e?(document.cookie="corelGA_Debug=true; path=/",o=!0):"tracking"!=e&&!n("corelGA_Debug")||(o=!0),o&&(void 0!==window.addEventListener?window.addEventListener("beforeunload",function(e){e.preventDefault(),e.returnValue=""}):void 0!==window.attachEvent&&window.attachEvent("onbeforeunload",function(e){e.preventDefault(),e.returnValue=""}))},e.trackEvent=function(e){r(e)},e.clickEvent=function(e){r(e)},e.pageViewEvent=function(e){var t={event:"e_gtmHandlerReady"};t.userId=function(){var e=n("corelGA-userId");""===e&&(e=k("ga-user-id"));return""===e?void 0:(function(e,t){t=e+"="+t+"; domain="+location.hostname.split(".").slice(-2).join(".")+"; path=/; max-age=63072000";document.cookie=t}("corelGA-userId",e),e)}(),dataLayer.push(t),y("Event Triggered",t),r(e);e=document.querySelectorAll("div[data-track-event=e_formView]");(e||[]).length&&r(e[0])},e.languageChange=function(e,t){var r={event:"e_languageChange"};r.oldLanguage=e.toUpperCase(),r.newLanguage=t.toUpperCase(),dataLayer.push(r),y("Event Triggered",r)};var f={},o=!1,h={e_addToCart:{requiredAttributes:["productsku"],optionalAttributes:["context"],enhancedEcomm:!0},e_ctaClick:{requiredAttributes:["ctaname"],optionalAttributes:["context"],enhancedEcomm:!1},e_formView:{requiredAttributes:["formname"],optionalAttributes:["context"],enhancedEcomm:!1},e_formSubmit:{requiredAttributes:["formname"],optionalAttributes:["context"],enhancedEcomm:!1},e_navigation:{requiredAttributes:["navcontent","navlocation"],optionalAttributes:[],enhancedEcomm:!1},e_popupView:{requiredAttributes:["popupname"],optionalAttributes:["context"],enhancedEcomm:!1},e_popupClick:{requiredAttributes:["popupname"],optionalAttributes:["context"],enhancedEcomm:!1},e_errorHttp:{requiredAttributes:[],optionalAttributes:["errorcode"],enhancedEcomm:!1},e_trialDownload:{requiredAttributes:["productsku"],optionalAttributes:["context"],enhancedEcomm:!1},e_trialDownloadStarted:{requiredAttributes:["productsku"],optionalAttributes:[],enhancedEcomm:!1},e_trialInstallSuccess:{requiredAttributes:["productsku"],optionalAttributes:[],enhancedEcomm:!1}},b={ctaname:["register","update-all","flash-sale-banner","close","hero-banner","click-email","click-phone","click-app2web","discountapplied","support","watch-video"]},A={invalidEvent:{id:"invalid-event",msg:"Invalid Event"},invalidAttribute:{id:"invalid-attribute",msg:"Invalid Attribute"},missingAttribute:{id:"missing-attribute",msg:"Missing Attribute"}};function r(e){var t,r,n=e.getAttribute("href"),i=e.getAttribute("data-track-event");if(null!=n&&null==i&&n.match(/\.chm$|\.dmg$|\.docx$|\.exe$|\.msi$|\.msp$|\.ova$|\.pdf$|\.pkg$|\.png$|\.rar$|\.rtf$|\.vhd$|\.xlsx$|\.zip$/i))return t=e,(r={event:"e_fileDownload"}).pageurl=location.href,r.clickurl=t.getAttribute("href"),void(0<(t=r.clickurl.lastIndexOf("/"))?(r.filename=r.clickurl.substring(t+1),dataLayer.push(r),y("Event Triggered",r)):(r.filename=null,w(A.missingAttribute,r)));var o=[];for(null!=i&&(o=i.split(",")),x=0;x<o.length;x++){var a=!1,u={};if(u.event=o[x].trim(),u.pageurl=location.href,null!=n&&(u.clickurl=n),h.hasOwnProperty(u.event)){for(var c=0;c<h[u.event].optionalAttributes.length;c++){var d=h[u.event].optionalAttributes[c];null!=(l=e.getAttribute("data-track-attr-"+d))&&(u[d]=l)}"e_errorHttp"==u.event&&(u.referrer=document.referrer,""!=(g=k("httperror"))&&(u.errorcode=g));for(c=0;c<h[u.event].requiredAttributes.length;c++){var d=h[u.event].requiredAttributes[c],l=e.getAttribute("data-track-attr-"+d);if(null==(u[d]=l)){w(A.missingAttribute,u),a=!0;break}if(b.hasOwnProperty(d)){for(var s=b[d],p=!1,c=0;c<s.length;c++)if(l==s[c]){p=!0;break}if(!p){w(A.invalidAttribute,u),a=!0;break}}}if(h[u.event].enhancedEcomm){if(!u.hasOwnProperty("productsku")){w(A.missingAttribute,u),a=!0;continue}var m={add:{}},v={},g=function(e){var t=null;if(f.hasOwnProperty("products"))for(var r=0;r<f.products.length;r++)if(f.products[r].hasOwnProperty("sku")&&e==f.products[r].sku){f.products[r].hasOwnProperty("price")&&((t={}).price=f.products[r].price,f.hasOwnProperty("currency")&&(t.currency=f.currency));break}return t}(u.productsku);v.id=u.productsku,m.add.products=[],null!=g&&(m.currencyCode=g.currency,v.price=g.price,v.quantity=null==e.getAttribute("data-track-attr-quantity")?1:e.getAttribute("data-track-attr-quantity")),m.add.products.push(v),u.ecommerce=m}a||(dataLayer.push(u),y("Event Triggered",u))}else w(A.invalidEvent,u),a=!0}}function n(e){return(document.cookie.match(e+"=([^;].+?)(;|$)")||[])[1]||""}function k(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");e=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.search);return null==e?"":decodeURIComponent(e[1].replace(/\+/g," "))}function w(e,t){var r={event:"e_malformedEvent"};r.errortype=e.id,r.errorevent=t.event;var n,i="";for(n in t)t.hasOwnProperty(n)&&"event"!=n&&(i+=n+":"+t[n]+"|");i=i.substring(0,i.length-1),r.errordata=i,dataLayer.push(r),y(e.msg,t,!0)}function y(e,t,r){if(-1==window.navigator.userAgent.indexOf("Mac")&&void 0!==window.console.log||-1!=window.navigator.userAgent.indexOf("Mac")&&-1!=window.navigator.userAgent.indexOf("Safari")){var n,i="[COREL GTM] "+e.toUpperCase()+": "+t.event+"\n";for(n in t)t.hasOwnProperty(n)&&(i+="     "+n+": "+("ecommerce"==n?"undefined"==typeof JSON?"Not supported in IE7":JSON.stringify(t[n]):t[n])+"\n");r?console.error(i):o&&console.log(i)}}}(window.tracking=window.tracking||{}),function(){tracking.initDebug();for(var e=document.querySelectorAll("a,button"),t=0;t<e.length;t++)void 0!==e[t].addEventListener?e[t].addEventListener("click",function(){tracking.clickEvent(this)},!0):void 0!==e[t].attachEvent&&e[t].attachEvent("onclick",function(){tracking.clickEvent(this)});tracking.pageViewEvent(document.body)}();